<html lang="es">
<head>
<meta charset="UTF-8">
<title>ZCASH NODE TERMINAL</title>
<style>
body { background: #000; color: #fff; font-family: "Lucida Console", monospace; padding: 20px; }
.terminal { max-width: 80ch; white-space: pre-wrap; }
.footer {
  margin-top:auto;
  padding:20px 0;
  color:#aaa;
}
a, a:visited, a:hover, a:active {
    color: #DD9D34;
    text-decoration: none; 
}
a:hover {
    text-decoration: underline; 
}
</style>
</head>
<body>
<div class="terminal" id="terminal">
EXPLORADOR DE BLOQUES TERMINAL (ZCASH)
=======================================
Cargando...
</div>
<div class="footer">--------------------------------------------------------------------------------<br>© 2026 Creada con ♥ por cΔrovΣr0 | apoya: t1NxVLsRg4kNqMHE2bqmFL5Qizr2JDtmumU</div>

<script>
async function loadData() {
    const terminal = document.getElementById('terminal');
    terminal.innerHTML = `EXPLORADOR DE BLOQUES TERMINAL (ZCASH)
=======================================
Cargando...`;

    let output; // ← DECLARADA ACÁ (visible en todo el bloque)

    try {
        const response = await fetch("https://carover0.xyz/zec/status.json");
        
        if (!response.ok) {
            throw new Error(`HTTP ${response.status}`);
        }
        
        const data = await response.json();
        
        // Calcular uptime
        const uptimeSec = data.node.uptime_seconds;
        const days = Math.floor(uptimeSec / 86400);
        const hours = Math.floor((uptimeSec % 86400) / 3600);
        
        // Versión a mostrar
        const version = data.versions.zcashd || 'N/A';
        
        output = `EXPLORADOR DE BLOQUES TERMINAL (ZCASH)
=======================================

BLOQUE ACTUAL : ${data.chain.height.toLocaleString()}
FECHA         : ${data.datetime}
CONEXIONES    : ${data.network.connections} (${data.network.inbound} IN · ${data.network.outbound} OUT)
UPTIME        : ${days}d ${hours}h
VERSION       : Zebra ${version}
TIMESTAMP     : ${data.timestamp} (${new Date(data.timestamp*1000).toLocaleTimeString()})

<a href="https://carover0.github.io/pagina/zcashstats.html">[ZCASH]</a> <a href="https://carover0.github.io/pagina/buscar-zec.html">[BUSCAR]</a> <a href="https://carover0.github.io/pagina/zec-consola.html">[CONSOLA]</a>

ULTIMOS 15 BLOQUES
--------------------------------------------------------------------------------
bloque  tx  hash                                            fecha
--------------------------------------------------------------------------------`;

        data.recent.blocks
            .sort((a, b) => b.height - a.height)
            .forEach(b => {
                const fecha = new Date(b.time * 1000).toLocaleString();
                const hashMostrado = b.hash.substring(0,22) + '...' + b.hash.slice(-22);
                output += `\n${String(b.height).padEnd(6)} ${String(b.tx_count).padEnd(3)} ${hashMostrado.padEnd(22)} ${fecha}`;
        });
        
        output += `\n\nULTIMAS 30 TRANSACCIONES 
--------------------------------------------------------------------------------
monto ZEC    hash
--------------------------------------------------------------------------------`;
        const txsToShow = data.recent.transactions.slice(0, 30);
        txsToShow.forEach(t => {
            const valor = (t.value === null || Math.abs(t.value) === 0) ? "PRIVADA" : t.value.toFixed(6);
            output += `\n${valor.padEnd(11)}  ${t.txid}`;
        });        
        
        output += `\n\n--------------------------------------------------------------------------------
MEMPOOL (${data.mempool.size} TRANSACCIONES)
--------------------------------------------------------------------------------`;

        if (data.mempool.transactions?.length) {
            data.mempool.transactions.forEach(tx => {
                const txid = tx.txid.substring(0,64);
                const valor = tx.visible ? `${tx.value_zec.toFixed(6)} ZEC` : 'PRIVADA';
                output += `\n${txid} ${valor}`;
            });
        } else {
            output += `\nMempool vacío`;
        }

        terminal.innerHTML = output;
        
    } catch (error) {
        terminal.innerHTML = `ERROR: No se pudo cargar. Verificá CORS en el servidor.\n${error.message}`;
        if (output) console.log("Partial output:", output);
    }
}

loadData();
setInterval(loadData, 60000);
</script>

</body>
</html>
