<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8"/>
  <title>RetroSearch v1.0 (test 10)</title>
 <style>
  body {
    background-color: black;
    color: white;
    font-family: 'Lucida Console', monospace;
    padding: 20px;
    font-size: 16px;
  }

  .line {
    margin-bottom: 16px;
  }

  input {
    background-color: black;
    color: white;
    border: none;
    border-bottom: 1px solid lime;
    font-family: 'Lucida Console', monospace;
    font-size: 16px;
    width: 80%;
    outline: none;
  }

  pre {
    white-space: pre-wrap;
    color: white;
  }

  ::selection {
    background: white;
    color: black;
  }

  input::placeholder {
    color: #fff;
    opacity: 0.5;
  }
  </style>
</head>
<body> <pre>
██████╗ ███████╗████████╗██████╗  ██████╗ ███████╗███████╗ █████╗ ██████╗  ██████╗██╗  ██╗
██╔══██╗██╔════╝╚══██╔══╝██╔══██╗██╔═══██╗██╔════╝██╔════╝██╔══██╗██╔══██╗██╔════╝██║  ██║
██████╔╝█████╗     ██║   ██████╔╝██║   ██║███████╗█████╗  ███████║██████╔╝██║     ███████║
██╔══██╗██╔══╝     ██║   ██╔══██╗██║   ██║╚════██║██╔══╝  ██╔══██║██╔══██╗██║     ██╔══██║
██║  ██║███████╗   ██║   ██║  ██║╚██████╔╝███████║███████╗██║  ██║██║  ██║╚██████╗██║  ██║
╚═╝  ╚═╝╚══════╝   ╚═╝   ╚═╝  ╚═╝ ╚═════╝ ╚══════╝╚══════╝╚═╝  ╚═╝╚═╝  ╚═╝ ╚═════╝╚═╝  ╚═╝

  <div class="line">Buscar: <input id="search" placeholder="Término o direccion" />
  </pre>  
  [F5 - Refrescar]  
  </div>
  <pre id="resultados" class="line"></pre>

  <script>
    // === 1) Arrancamos con un log para confirmar que este script SE CARGA ===
    console.log('🚀 pr2.html script inicializado');

    // === 2) Declaramos buscar() COMO FUNCIÓN GLOBAL ===
    async function buscar() {
      const term = document.getElementById('search').value.trim();
      const resultadosEl = document.getElementById('resultados');

      if (!term) {
        resultadosEl.innerText = "Error: ingrese un término.";
        console.log("No se ingresó término de búsqueda");
        return;
      }

      resultadosEl.innerText = `Buscando "${term}"...\n\nPor favor espere...\n`;

      try {
        const res = await fetch(
          `https://caropowershell-proxy.onrender.com/duck?q=${encodeURIComponent(term)}`
        );
        console.log('Fetch status:', res.status);

        if (res.status !== 200) {
          console.error("Hubo un error con la API");
          resultadosEl.innerText = `Error de la API, status: ${res.status}`;
          return;
        }

        const data = await res.json();
        console.log('Datos recibidos:', data);

        if (data && data.length) {
          let out = `Resultados para "${term}":\n\n`;
          data.slice(0,15).forEach((item, i) => {
            out += `[${i+1}] ${item.title}\n`;
            out += `    URL: ${item.url}\n`;
            out += `    ${item.snippet}\n\n`;
          });
          resultadosEl.innerText = out;
        } else {
          resultadosEl.innerText = "No se encontraron resultados.";
        }
      } catch (e) {
        console.error('Error de fetch:', e);
        resultadosEl.innerText = `Error al buscar "${term}". Detalles: ${e.message}`;
      }
    }

    // === 3) Al cargar el DOM, asignamos el listener y comprobamos que buscar existe ===
    window.addEventListener('DOMContentLoaded', () => {
      console.log('Listener asignado, buscar() disponible:', typeof buscar);
      const input = document.getElementById('search');
      input.focus();
      input.addEventListener('keydown', e => {
        if (e.key === 'Enter') {
          console.log('Enter detectado — llamando a buscar()');
          buscar();
        }
      });
    });
  </script>
</body>
</html>



