<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8"/>
  <title>RetroSearch Test</title>
  <style>
    body {
      background: black;
      color: lime;
      font-family: 'Lucida Console', monospace;
      padding: 20px;
    }
    .line {
      margin-bottom: 10px;
    }
    input {
      background: black;
      border: none;
      border-bottom: 1px solid lime;
      color: lime;
      font-family: inherit;
      width: 80%;
      outline: none;
    }
    pre {
      white-space: pre-wrap;
    }
  </style>
</head>
<body>
  <div class="line">RetroSearch v1.0 (test 7)</div>
  <div class="line">C:\search&gt; <input id="search" placeholder="Término..." /></div>
  <pre id="resultados" class="line"></pre>

  <script>
    // Definimos buscar() en el scope global
    window.buscar = async function() {
      const term = document.getElementById('search').value.trim();
      const resultadosEl = document.getElementById('resultados');
      if (!term) {
        resultadosEl.innerText = "Error: ingrese un término.";
        return;
      }

      resultadosEl.innerText = `Buscando "${term}"...\n\nPor favor espere...\n`;

      try {
        const res = await fetch(
          `https://caropowershell-proxy.onrender.com/duck?q=${encodeURIComponent(term)}`
        );
        console.log('Fetch status:', res.status);
        const data = await res.json();
        console.log('Fetch data:', data);

        if (data && data.length) {
          let out = `Resultados para "${term}":\n\n`;
          data.slice(0, 5).forEach((item, i) => {
            out += `[${i+1}] ${item.title}\n`;
            out += `    URL: ${item.url}\n`;
            out += `    ${item.snippet}\n\n`;
          });
          resultadosEl.innerText = out;
        } else {
          resultadosEl.innerText = "No se encontraron resultados.";
        }
      } catch (e) {
        console.error('Error de fetch:', e);
        resultadosEl.innerText = `Error al buscar "${term}".`;
      }
    };

    // Enlazamos el listener al input una vez cargado el DOM
    window.addEventListener('DOMContentLoaded', () => {
      const input = document.getElementById('search');
      input.focus();
      console.log('Listener asignado, buscar() disponible:', typeof window.buscar);
      input.addEventListener('keydown', e => {
        if (e.key === 'Enter') {
          console.log('Enter detectado — llamando a buscar()');
          window.buscar();
        }
      });
    });
  </script>
</body>
</html>



</body>
</html>


