<html lang="es">
<head>
<meta charset="UTF-8">
<title>EXPLORADOR FIRO</title>
<style>
body { background: #000; color: #fff; font-family: "Lucida Console", monospace; padding: 20px; }
.terminal { max-width: 80ch; white-space: pre-wrap; }
.footer {
  margin-top:auto;
  padding:20px 0;
  color:#aaa;
}
a, a:visited, a:hover, a:active {
    color: #9B1C2E;
    text-decoration: none; 
}
a:hover {
    text-decoration: underline; 
}

</style>
</head>
<body>
<div class="terminal" id="terminal">
CARGANDO 
========
Cargando...
</div>
<div class="footer">--------------------------------------------------------------------------<br>© 2026 Creada con ♥ por cΔrovΣr0 | apoya: carover0.firo</div>

<script>
let data = null;

async function loadData() {
    try {
        // Leer DIRECTO (sin proxy)
        const response = await fetch("https://carover0.xyz/zfiro.txt");
        if (!response.ok) throw new Error(`HTTP ${response.status}`);
        
        const text = await response.text();
        
        const lines = text.split('\n').filter(line => line.trim());
        data = {
            blocks: [],
            transactions: []
        };
        
        lines.forEach(line => {
            const parts = line.split('|');
            if (parts[0] === 'BLOCK') {
                data.blocks.push({
                    height: parts[1],
                    hash: parts[2],
                    time: parts[3],
                    tx_count: parts[4],
                    size: parts[5]
                });
            } else if (parts[0] === 'TX') {
                let inputs = [];
                let outputs = [];
                
                if (parts[5]) {
                    const items = parts[5].split(';').filter(item => item.trim() !== '');
                    
                    items.forEach(item => {
                        if (item.startsWith('<-')) {
                            const [_, address, value] = item.match(/<- (\w+):([\d.]+)/) || [];
                            if (address && value) {
                                inputs.push({
                                    address: address,
                                    value: parseFloat(value)
                                });
                            }
                        } else if (item.startsWith('->')) {
                            const [_, address, value] = item.match(/-> (\w+):([\d.]+)/) || [];
                            if (address && address !== 'undefined' && address !== 'null' && value) {
                                outputs.push({
                                    address: address,
                                    value: parseFloat(value)
                                });
                            }
                        }
                    });
                }
                
                data.transactions.push({
                    txid: parts[1],
                    block_height: parts[2],
                    value_out: parts[3] === 'null' ? null : parseFloat(parts[3]),
                    time: parts[4],
                    inputs: inputs,
                    outputs: outputs
                });
            }
        });
        
        document.getElementById('nodeInfo').innerHTML = 
            `> BUSCAR\n> ${data.blocks.length} bloques · ${data.transactions.length} transacciones, ≈ 6h 25m atras\n\n<a href="https://carover0.github.io/pagina/explorer.html">[EXPLORADOR]</a> <a href="https://carover0.github.io/pagina/firostats.html">[FIRO]</a>`;
        
        console.log("Datos cargados:", data);
        
    } catch (e) {
        document.getElementById('nodeInfo').innerHTML = 'Error cargando datos: ' + e.message;
        console.error(e);
    }
}

function formatDate(timestamp) {
    return new Date(timestamp * 1000).toLocaleString();
}

function search() {
    if (!data) {
        document.getElementById('output').innerHTML = 'Datos no cargados aún';
        return;
    }
    
    const input = document.getElementById('search');
    const q = input.value.trim().toLowerCase();
    if (!q) return;
    
    let out = '';
    let encontrados = 0;
    
    data.blocks.forEach(b => {
        if (b.height.includes(q) || b.hash.toLowerCase().includes(q)) {
            encontrados++;
            out += `\n■ BLOQUE #${b.height}\n`;
            out += `  hash: ${b.hash}\n`;
            out += `  time: ${formatDate(b.time)}\n`;
            out += `  tx: ${b.tx_count} · size: ${b.size}b\n`;
        }
    });
    
    data.transactions.forEach(t => {
        let matchInInputs = t.inputs?.some(o => 
            (o.address?.toLowerCase().includes(q)) || 
            (o.value?.toString().includes(q))
        ) || false;
        
        let matchInOutputs = t.outputs?.some(o => 
            (o.address?.toLowerCase().includes(q)) || 
            (o.value?.toString().includes(q))
        ) || false;
        
        if (t.txid.toLowerCase().includes(q) || 
            (t.value_out !== null && t.value_out.toString().includes(q)) || 
            t.block_height.includes(q) ||
            matchInInputs ||
            matchInOutputs) {
            
            encontrados++;
            out += `\n• TX ${t.txid}\n`;
            out += `  block: #${t.block_height}\n`;
            out += `  time: ${formatDate(t.time)}\n`;
            
            if (t.value_out !== null) {
                out += `  total: ${t.value_out.toFixed(4)} FIRO\n`;
            }
            
            if (t.inputs?.length) {
                t.inputs.forEach(input => {
                    if (input.address && input.address !== 'undefined' && input.address !== 'null') {
                        out += `  <- ${input.address} : ${input.value.toFixed(4)} FIRO\n`;
                    }
                });
            }
            
            if (t.outputs?.length) {
                t.outputs.forEach(output => {
                    if (output.address && output.address !== 'undefined' && output.address !== 'null') {
                        out += `  -> ${output.address} : ${output.value.toFixed(4)} FIRO\n`;
                    }
                });
            }
        }
    });    
    
    document.getElementById('output').innerHTML = 
        encontrados > 0 ? out : '> no results';
    
    input.value = '';
}

loadData();
setInterval(loadData, 60000);

const input = document.getElementById('search');
input.addEventListener('keypress', e => { 
    if (e.key === 'Enter') {
        search();
    }
});

window.onload = () => input.focus();
</script>

  
</body>
</html>
